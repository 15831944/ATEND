using System;
using System.Collections.Generic;
using System.Text;
using System.Data;
using System.Data.OleDb;
using System.Data.SqlClient;
using Autodesk.AutoCAD.EditorInput;


//using Autodesk.AutoCAD.EditorInput;
using Autodesk.AutoCAD.ApplicationServices;


namespace Atend.Base.Base
{
    public class BPlan
    {
        //private int code;

        //public int Code
        //{
        //    get { return code; }
        //    set { code = value; }
        //}

        //private string title;

        //public string Title
        //{
        //    get { return title; }
        //    set { title = value; }
        //}


        //public bool Insert()
        //{
        //    SqlConnection Connection = new SqlConnection(Atend.Control.ConnectionString.cnString);
        //    SqlCommand Command = new SqlCommand("B_Plan", Connection);
        //    Command.CommandType = CommandType.StoredProcedure;
        //    Command.Parameters.Add(new SqlParameter("iCode", Code));
        //    Command.Parameters.Add(new SqlParameter("iTitle", Title));
        //    try
        //    {
        //        Connection.Open();
        //        Command.ExecuteNonQuery();
        //        Connection.Close();
        //        return true;
        //    }
        //    catch (System.Exception ex1)
        //    {
        //        Editor ed = Application.DocumentManager.MdiActiveDocument.Editor;
        //        ed.WriteMessage(string.Format(" ERROR B_Plan.Insert {0}\n", ex1.Message));

        //        Connection.Close();
        //        return false;
        //    }
        //}


        //public bool AccessInsert()
        //{
        //    OleDbConnection Connection = new OleDbConnection("PROVIDER=Microsoft.Jet.OLEDB.4.0;Data Source=" + Atend.Control.Common.AccessPath);

        //    OleDbCommand Command = new OleDbCommand("B_Plan", Connection);
        //    Command.CommandType = CommandType.StoredProcedure;
        //    Command.Parameters.Add(new OleDbParameter("iCode", Code));
        //    Command.Parameters.Add(new OleDbParameter("iTitle", Title));
        //    try
        //    {
        //        Connection.Open();
        //        Command.ExecuteNonQuery();
        //        Connection.Close();
        //        return true;
        //    }
        //    catch (System.Exception ex1)
        //    {
        //        Editor ed = Application.DocumentManager.MdiActiveDocument.Editor;
        //        ed.WriteMessage(string.Format(" ERROR B_Plan.AccessInsert {0}\n", ex1.Message));

        //        Connection.Close();
        //        return false;
        //    }
        //}

        //public static BPlan SelectByCode(int Code)
        //{
        //    SqlConnection Connection = new SqlConnection(Atend.Control.ConnectionString.cnString);
        //    SqlCommand Command = new SqlCommand("B_Plan_Select", Connection);
        //    Command.CommandType = CommandType.StoredProcedure;
        //    Command.Parameters.Add(new SqlParameter("iCode", Code));
        //    Connection.Open();
        //    SqlDataReader reader = Command.ExecuteReader();
        //    BPlan plan = new BPlan();
        //    if (reader.Read())
        //    {
        //        plan.Code = Convert.ToInt32(reader["Code"].ToString());
        //        plan.Title = reader["Title"].ToString();
        //    }
        //    Connection.Close();
        //    reader.Close();
        //    return plan;
        //}

        //public static BPlan AccessSelectByCode(int Code)
        //{
        //    OleDbConnection Connection = new OleDbConnection("PROVIDER=Microsoft.Jet.OLEDB.4.0;Data Source=" + Atend.Control.Common.AccessPath);

        //    OleDbCommand Command = new OleDbCommand("B_Plan_Select", Connection);
        //    Command.CommandType = CommandType.StoredProcedure;
        //    Command.Parameters.Add(new OleDbParameter("iCode", Code));
        //    Connection.Open();
        //    OleDbDataReader reader = Command.ExecuteReader();
        //    BPlan plan = new BPlan();
        //    if (reader.Read())
        //    {
        //        plan.Code = Convert.ToInt32(reader["Code"].ToString());
        //        plan.Title = reader["Title"].ToString();
        //    }
        //    Connection.Close();
        //    reader.Close();
        //    return plan;
        //}


        //public static DataTable SelectAll()
        //{
        //    SqlConnection Connection = new SqlConnection(Atend.Control.ConnectionString.cnString);
        //    SqlDataAdapter adapter = new SqlDataAdapter("B_Plan_Select", Connection);
        //    adapter.SelectCommand.CommandType = CommandType.StoredProcedure;
        //    adapter.SelectCommand.Parameters.Add(new SqlParameter("iCode", 0));
        //    DataSet dsPlan = new DataSet();
        //    adapter.Fill(dsPlan);
        //    return dsPlan.Tables[0];
        //}

        //public static DataTable AccessSelectAll()
        //{
        //    OleDbConnection Connection = new OleDbConnection("PROVIDER=Microsoft.Jet.OLEDB.4.0;Data Source=" + Atend.Control.Common.AccessPath);

        //    OleDbDataAdapter adapter = new OleDbDataAdapter("B_Plan_Select", Connection);
        //    adapter.SelectCommand.CommandType = CommandType.StoredProcedure;
        //    adapter.SelectCommand.Parameters.Add(new OleDbParameter("iCode", 0));
        //    DataSet dsPlan = new DataSet();
        //    adapter.Fill(dsPlan);
        //    return dsPlan.Tables[0];
        //}

    }
}
